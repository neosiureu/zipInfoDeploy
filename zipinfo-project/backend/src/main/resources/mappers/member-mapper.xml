<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.zipinfo.project.member.model.mapper.MemberMapper">
<select id="login"> SELECT *
FROM MEMBER WHERE MEMBER_EMAIL = #{memberEmail} 
AND MEMBER_DEL_FL ='N' AND MEMBER_LOGIN = #{memberLogin} </select>

<select id="checkEmail"> SELECT COUNT(*)
	FROM "MEMBER"
	WHERE MEMBER_EMAIL = #{memberEmail}
	AND MEMBER_DEL_FL = 'N'AND MEMBER_LOGIN = 'E'
	</select>
<select id="checkNickname">
  	SELECT COUNT(*)
  	FROM "MEMBER"
  	WHERE MEMBER_NICKNAME = #{checkNickname}
  	</select>

<select id="checkBrokerNo">
  SELECT COUNT(*)
  FROM BROKER_INFO bi
  WHERE bi.BROKER_NO = #{brokerNo}
</select>


<insert id="signupGeneral" >
  	 INSERT INTO "MEMBER"
     VALUES(SEQ_MEMBER.NEXTVAL, 
			 #{memberEmail},
			 #{memberPw},
			 DEFAULT,
			 DEFAULT,
			 DEFAULT,
			 #{memberLogin},
			 #{memberNickname},
			 #{memberName},
			 1,
			 DEFAULT,
			 #{memberLocation}			 
                    )
  	</insert>


<insert id="signupBroker" >
  	 INSERT INTO "BROKER_INFO"
     VALUES(SEQ_MEMBER.CURRVAL, 
			 #{companyLocation},
			 #{companyName},
			 #{presidentName},
			 #{brokerNo},
			 #{presidentPhone}			 
			 			 
                    )
  	</insert>

<!-- 관리자 인증 -->
	<select id="selectByEmail" parameterType="string" resultType="com.zipinfo.project.member.model.dto.Member">
		  SELECT 
		    member_no,
		    member_email,
		    member_pw,
		    member_auth,
		    member_name,
		    member_nickname,
		    member_location,
		    member_del_fl
		  FROM member
		  WHERE member_email = #{email}
		    AND member_del_fl = 'N'
		</select>

<update id="updatePassword">
UPDATE MEMBER SET MEMBER_PW = #{memberPw} WHERE MEMBER_EMAIL = #{memberEmail} AND MEMBER_LOGIN = #{memberLogin}
</update>
	

</mapper>
